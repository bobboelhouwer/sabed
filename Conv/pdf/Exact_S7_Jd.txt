30/10/2019

Aanvullingen

Responsie op
ingangssignalen en begintoestand

1

 30/10/2019

Responsie berekenen
â€¢ Gegeven toestandsbeschrijving (A, B, C, D) ,
u[k] en x[0], wat zijn x[k] en y[k] ?
â€¢ Toestandsbeschrijving
x[k+1] = A x[k] + B u[k]
y[k] = C x[k] + D u[k]
â€¢ Exhaustieve berekening van x[k] en y[k]

Voorbeeld
x2[k]

x1[k]
x3[k]

Gegeven

2

 30/10/2019

â€œOplossenâ€ toestandsvergelijking
â€¢ Gegeven toestandsbeschrijving, u[k] en x[0], wat zijn x[k] en y[k] ?
â€¢ Toestandsbeschrijving
x[k+1] = A x[k] + B u[k]
y[k] = C x[k] + D u[k]
â€¢ Voorheen: x[k+1] = A x[k] â‡’ x[k] = Ak x[0]
â€¢ Nu: k = 0: x[1] = A x[0] + B u[0]
k = 1: x[2] = A x[1] + B u[1] = A (A x[0] + B u[0]) + B u[1]
= A2 x[0] + ABu[0] + Bu[1]
k = 2: x[3] = A x[2] + B u[2] = A3 x[0] + A2Bu[0] + ABu[1] + Bu[2]
Algemeen:
â€¢ Uitgangssignaal
â€¢ y[0] = C x[0] + D u[0]

k>0

k>0

Nulingangs- en nultoestandsrespons

Nulingangsresponsie

Nultoestandsresponsie

â€¢ Nulingangsresponsie: y[k] als u[k] = 0 âˆ€ k
â€¢ Nultoestandsresponsie: y[k] als x[0] = 0

3

 30/10/2019

Toestandsbeschrijving en
gelijkvormige matrices

Toestandsbeschrijving is niet uniek
â€¢ x[k] = P w[k] met P = [p1, ... , pn] een nxn inverteerbare matrix
â€“ Is verandering van coÃ¶rdinaten: w[k] zijn de coordinaten van x[k] in de
basis {p1, ... , pn}

â€¢ P w[k+1] = A P w[k] + B u[k]
P-1 P w[k+1] = P-1 A P w[k] + P-1 B u[k]

=I


= 


= 

 w[k] +  
 u[k]
w[k+1] =  
â€¢ y[k] = C x[k] + D u[k] = C P w[k] + D u[k]

=  

 u[k]
y[k] = Ì… w[k] +  


= 

4

 30/10/2019

Toestandsbeschrijving is niet uniek
â€¢ In de nieuwe toestandsvector w[k] hebben we een
equivalente toestandsbeschrijving:
 w[k] +  
 u[k]
w[k+1] =  
 

y[k] =  w[k] +   u[k]
 = P-1 A P ;  
 = P-1 B ;   = 
â€¢  
 zijn gelijkvormig
A en  

 = 
; 

â€¢ Beide systemen zijn equivalent. Let wel op initiÃ«le
toestand. Nulingangsresponsie:
 k w[0] = P-1 Ak P w[0]
w[k] =  
â‡” P w[k] = Ak P w[0] â‡” x[k] = Ak x[0]
Zorg ervoor dat P w[0] = x[0], dan is ook P w[k] = x[k]
voor k>0, en dus y[k]=   w[k] = C x[k]

Voorbeeld
u[k]

+

x2[k+1]

D

x2[k]
x1[k+1]

+

D

y[k]
x1[k]

1/4

[ + 1]
0
=
1/4
+ 1]

 [

  = 1 0
 =

0
1/4

1
0

[]

 []

+

[]
 []

1
0
;  =
; = 1
0
1

0
 []
1

0 ;  = 0

5

 30/10/2019

Voorbeeld (2)
=
 



= 
 
  = 
u[k]

1 âˆ’1
â‡”
1 1
1 5
3
  =
8 âˆ’3 âˆ’5
1 1
 =
2 1
= 1 âˆ’1
=

Kies

1/2



=

+



1
âˆ’1

1
zodat x[k] = P w[k]
1
[ + 1]
5/8
3/8
=
âˆ’3/8 âˆ’5/8
 [ + 1]
[]
   = 1 âˆ’1
 []

w1[k+1]

+

+

D

w1[k]

[]

 []

+

+

1/2
 []
1/2

y[k]

5/8

3/8
5/8

+

-

3/8

w2[k+1]

D

w2[k]

Toestandsbeschrijving en
matrixdiagonalisatie

6

 30/10/2019

Diagonaalvorm
â€¢ Veronderstel dat A diagonaliseerbaar is
â€¢ Herinner x[k] = P w[k]
â€¢ Kies P = [v1, ... , vn] met vi eigenvector van A met
eigenwaarde Î»i
! â‹¯ 0
-1

â€¢ Dan wordt   = P A P = â‹® â‹± â‹® = Î›
0 â‹¯ !%
 u[k] ; y[k] =   w[k] +  
 u[k]
â€¢ w[k+1] = Î› w[k] +  
â€¢ Voor SISO systeem:
w[k+1] = Î› w[k] + &Ì… u[k] ; y[k] = 'Ì… w[k] + (Ì… u[k]
wi[k+1] = Î»i wi[k] + b * u[k] i = 1 â€¦ n
â€¢ Toestand i beinvloedt toestand j â‰  i niet

Diagonaalvorm voor SISO systeem
â€¢ Som van
eerste-orde
systemen
â€¢ Plus directe
verbinding
met winst +Ì…

7

 30/10/2019

Voorbeeld
0
1
1/4 0
K.P.: Î»2-1/4 = (Î»-1/2)(Î»+1/2)
2
2 âˆ’2
1 2
Î»1 = Â½ â‡’ , =
=
â‡”  =
- âˆ’1 2
1
1 1
â„
0
âˆ’2
=    = 
Î»2 = -Â½ â‡’ , =
 
1
0 âˆ’ â„
 =    = 1 ; Ì… =  = 2 âˆ’2
 
 1
 =

u[k]

1/2

+

w1[k+1]

+

D

w1[k]

+

y[k]

2

-

1/2
-1/2

+
1/2

+
w2[k+1]

D

w2[k]

2

Minimaliteit
â€¢

â€¢

â€¢

Voor sommige systemen kan een
/ * = 0. De toestandsveranderlijke
wi[k] kan dan niet beÃ¯nvloed
worden. Het systeem is niet
controleerbaar.
Voor sommige systemen kan een
0Ì…* = 0. De toestandsveranderlijke
wi[k] kan de uitvoer niet
beÃ¯nvloeden. Het systeem is niet
observeerbaar.
Een systeem dat niet observeerbaar
en/of niet controleerbaar is heet
niet-minimaal. Hetzelfde ingangsuitgangsgedrag kan gerealiseerd
worden met een kleiner aantal
geheugenelementen.

8

 30/10/2019

Inwendige (interne) stabiliteit
â€¢ Een systeem is inwendig stabiel als x[k] â†’ 0
als kâ†’âˆ bij u[k]=0 en dit voor alle x[0]
â€¢ x[k] = Ak x[0] = P Î›k P-1 x[0] = P Î›k w[0]
= w1[0] Î»1k v1 + â€¦ + wn[0] Î»nk vn
â€¢ Inwendig instabiel zodra Ã©Ã©n | Î»i |â‰¥1
â€¢ Inwendig stabiel â‡” | Î»i | < 1 voor i = 1 â€¦ n

Nulingangsresponsie

Nulingangsresponsie

Nultoestandsresponsie

â€¢ Ak x[0] bestuderen
â€¢ y[k] = c Ak x[0] (c = rijvector; SISO system)

9

 30/10/2019

Nulingangsresponsie
â€¢ x[k] = Ak x[0] = P Î›k P-1 x[0] = P Î›k w[0]
= w1[0] Î»1k v1 + â€¦ + wn[0] Î»nk vn
w1[0]
â‹®
= P-1 x[0] is de coÃ¶rdinatenvector van x[0] in de
wn[0]
basis {v1 , â€¦ , vn}

â€¢ w[0] =

Î»1k w1[0]
â‹®
â€¢
=
= P-1 x[k] is de coÃ¶rdinatenvector van x[k] in de
k
Î»n wn[0]
basis {v1 , â€¦ , vn}
â€¢ y[k] = c x[k] = (c v1) w1[0] Î»1k + â€¦ + (c vn) wn[0] Î»nk
is een gewogen som van exponentiÃ«le functies in k
Î›k w[0]

Nulingangsresponsie
w2[0]v2
v2
Î»2 w2[0] v2
Î»22

x[0]

w2[0] v2

Î»23 w2[0] v2
Î»24 w2[0] v2

x[1]
x[2]
x[3]
x[4]

Î»1=3/4
Î»2=2/3
w1[0]v1

v1

10

 30/10/2019

Bijdragen tot nulingangsresponsie
|Î»| > 1

|Î»| < 1

|Î»| = 1

Î»>0

Î»<0

0 < Î»1 < 1 ; 0 < Î»2 < 1

Attractor / aantrekker
Inwendig stabiel

11

 30/10/2019

1 < Î»1 ; 1 < Î»2

Repeller / afstoter
Inwendig onstabiel

1 < Î»1 ; 0 < Î»2 < 1

Saddle point / zadelpunt
Inwendig onstabiel

12

 30/10/2019

Complexe eigenwaarden
â€¢ !* = 12 *34 ; !*5 = 12 *34 = !*

Ï‰ is genormaliseerde frequentie. 0 < 7 < 1

â€¢ Eigenvectoren vi en vi+1 = vi
â€¢ Neem complex toegevoegde termen samen in
y[k] = (c v1) w1[0] Î»1k + â€¦ + (c vn) wn[0] Î»nk
(cc is een reÃ«le rijvector; !E* = 1 E 2 *E34 )
' !E*

*

0 ,G + !E*

*

0 ,G

= 2 ' Re !E*

= 21 E ' Re 2 *E34 * 0 ,G
= 21 E Re 2 *E34 * 0 ',G

*

0 ,G

Complexe eigenwaarden (2)
â€¢ Noem

*

0 ' ,G = I 2 *J

â€¢ Bijdrage door complexe eigenwaarde in y[k] is
product van:
o Exponentieel verloop rk - zie reÃ«le eigenwaarde
o Golvend verloop cos(K + L7)

13

 30/10/2019

0 < |Î»1| < 1 ; 0 < |Î»2| < 1

Complexe eigenwaarden
Inwendig stabiel

Bijdrage tot nulingangsresponsie
r = |Î»| > 1

r = |Î»| < 1

r = |Î»| = 1

14

 30/10/2019

Canonieke vorm en
differentievergelijking

Canonieke vorm
â€¢ Zoek transformatiematrix Q = [q1, ... , qn] zodat door de
M = N  N en O& = N &
gelijkvormigheidstransformatie:  

M = N  N en O& = N &
â€¢  
O =&
M =  N en N&
â‡” N 
%
%
â€¢ K.P. is ! + PQ% !
+ â‹¯ + PQ ! + PQR

M noemen we een compagnon-matrix
   
M en A hebben dezelfde K.P. want gelijkvormig
   

â€¢ Constructie van Q â€“ zie later

15

 30/10/2019

O?
Waarom die Ãƒ en &

[ + 1]
[]
0
+ 1]
 []
0
â‹®
â‹®
=
+ â‹®  []
0
% [ + 1]
% []
1
% [ + 1]
% []
y[k] = 0Ìƒ w1[k] + 0Ìƒ w2[k] + ... + 0Ìƒ% wn[k] + +O u[k]
 [

Constructie van Q
â€¢

O =&
M en N&
 N = N 

â€¢

2de

vergelijking: T

â‹¯ T%

0
â‹®
= & â‡’ T% = &
0
1

16

 30/10/2019

Constructie van Q
â€¢ T% = & â‡’   T â‹¯ T% &
U T â‹¯ T% âˆ’ PQR &
â€¢ Kolom n: T% =  & + PQ%
â€¢ Kolom n-1: T%V =  T% +

=
PQ & â‹¯ PQ% &
&
PQ% &

â€¢ Kolom 2: TW =  TV + PQ &

O?
Waarom die Ãƒ en &

[ + 1]
+ 1]
â‹®
=
% [ + 1]
% [ + 1]
 [

w1[k+1] = w2[k]
w2[k+1] = w3[k]
 
wn-1[k+1] = wn[k]

[]

0
0
â‹®
+ â‹®  []
0
% []
1
[]
%
 []

w1[k+1] = w2[k]
w1[k+2] = w2[k+1] = w3[k]
 
w1[k+n-1] = w2[k+n-2] =  = wn[k]

wn[k+1]= -Ã£n-1 wn[k] -Ã£n-2 wn-1[k] - ... -Ã£0 w1[k] + u[k]
w1[k+n] + Ã£n-1 w1[k+n-1] + Ã£n-2 w1[k+n-2] + ... + Ã£0 w1[k] = u[k]

17

 30/10/2019

O?
Waarom die Ãƒ en &

Dus:
w1[k+n] + Ã£n-1 w1[k+n-1] + Ã£n-2 w1[k+n-2] + ... + Ã£0 w1[k] = u[k]
Uitgangsvergelijking:
y[k] = 0Ìƒ w1[k] + 0Ìƒ w2[k] + ... + 0Ìƒ% wn[k] + +O u[k]
Herschrijf:
y[k]-+O u[k] = 0Ìƒ w1[k] + 0Ìƒ w1[k+1] + ... + 0Ìƒ% w1[k+n-1]

w1[k] elimineren
w1[k+n] + Ã£n-1w1[k+n-1] + ... + Ã£0w1[k]
= u[k]
w1[k+n+1] + Ã£n-1w1[k+n] + ... + Ã£0w1[k+1] = u[k+1]
 
w1[k+2n-1] + Ã£n-1w1[k+2n-2]+ ... + Ã£0w1[k+n-1]= u[k+n-1]

Ã—0Ìƒ
Ã—0Ìƒ
Ã—0Ìƒ%

y[k+n] + Ã£n-1 y[k+n-1] + Ã£n-2 y[k+n-2] + ... + Ã£0 y[k]
= (0Ìƒ + Ã£0 +O ) u[k] + (0Ìƒ + Ã£1 +O ) u[k+1]+ ... + (0Ìƒ% + Ã£n-1 +O ) u[k+n-1] + +O u[k+n]

18

 30/10/2019

Differentievergelijking
y[k+n] + Ã£n-1 y[k+n-1] + Ã£n-2 y[k+n-2] + ... + Ã£0 y[k]
= +O u[k+n] + (0Ìƒ% + Ã£n-1 +O ) u[k+n-1] + ... + (0Ìƒ + Ã£1 +O ) u[k+1] +(0Ìƒ + Ã£0 +O ) u[k]
= fn u[k+n] + fn-1 u[k+n-1] + ... + f1 u[k+1] + f0 u[k]
â€¢ Rechtstreeks verband tussen u[k] en y[k]
â€¢ Dit heet een differentievergelijking
â€¢ Alternatief voor de toestandsbeschrijving

â€¢ Is een verband tussen differentievergelijking en canonieke vorm
â€¢ M.a.w.: gegeven een differentievergelijking
y[k+n] + Ã£n-1 y[k+n-1] + Ã£n-2 y[k+n-2] + ... + Ã£0 y[k]
= fn u[k+n] + fn-1 u[k+n-1] + ... + f1 u[k+1] + f0 u[k]
Dan komen daarmee toestandsbeschrijvingen overeen die allemaal dezelfde K.P.
hebben: !% + PQ% !% + â‹¯ + PQ ! + PQR
â€¢ Ook: gegeven een toestandsbeschrijving (A, b, c, d), dan komt daarmee een
differentievergelijking overeen waarbij de Ã£i ook de coÃ«fficiÃ«nten van de K.P.
van A zijn

Voorbeeld
1 5
3
8 âˆ’3 âˆ’5
1 1
&= =
2 1
 =

'== 1

âˆ’1

d=D = 0

â€¢

n=2

â€¢

K.P.: âˆ’

â€¢
â€¢

X
âˆ’
Y

!

X
Y

+! +

PQ = 0 ; PQR = âˆ’
1
q2=b=
 1
TW =  TV + PQ & =

[

Z
[-

5
âˆ’3

= ! âˆ’

[
[-

= ! âˆ’

-

1
3 1
=
 âˆ’1
âˆ’5 1

19

 30/10/2019

Voorbeeld
0 1
M= 1
 
0
4
O& =  
M= 0
1

'Q = \ = N =



= 1 0
M = =0
+O =  

Met Q =
u[k]



+

1

âˆ’1

1
âˆ’1

1
1

1 1
, canonieke vorm:
âˆ’1 1

y[k+2]

y[k+1]

D

+

D

y[k]

1/4

Voorbeeld
0 1
M= 1
 
0
4
O = 
M= 0
&
1

PQ = 0 ; PQR = âˆ’

0Ìƒ = 1 ; 0Ìƒ = 0
] = +O = 0; ] = 0Ìƒ + Ã£ 1+O = 0 ; ]R = 0Ìƒ + Ã£0 +O = 1

'Q = \ = N =



= 1 0
M = =0
+O =  
u[k]

1
4

+

1

âˆ’1

y[k+2]

1
âˆ’1

D

+

1
1

y[k+1]

D

y[k]

1/4

y[k+2] = u[k] +1/4 y[k]
y[k+2] â€“ Â¼ y[k] = u[k]

de differentievergelijking gehaald uit de canonieke vorm

20

 30/10/2019

Impulsresponsie en convolutie

Impulsresponsie
â€¢ Doel: berekenen van de responsie. We hadden al:
 Exhaustief


â€¢ Nultoestandsimpulsrespons (impulsrespons) h[k] van
een SISO DTLTI systeem is y[k] wanneer u[k] = Î´[k]
 Î´[k] = 1 voor k = 0 en Î´[k] = 0 voor k â‰  0
Î´[k]

h[k]

1

1
k

-7 -6 -5 -4 -3 -2 -1 0 1 2 3 4 5 6 7

k
-7 -6 -5 -4 -3 -2 -1 0 1 2 3 4 5 6 7

21

 30/10/2019

Verschoven impuls
Î´[k-1]

Î´[k]
1

1

k

k
-7 -6 -5 -4 -3 -2 -1 0 1 2 3 4 5 6 7

-7 -6 -5 -4 -3 -2 -1 0 1 2 3 4 5 6 7

Î´[k-2]

Î´[k-3]

1

1
k

-7 -6 -5 -4 -3 -2 -1 0 1 2 3 4 5 6 7

k
-7 -6 -5 -4 -3 -2 -1 0 1 2 3 4 5 6 7

Ontbinding u[k]
u[0]=2
u[1]=3
u[2]=1

=

2Î´[k]

+

3Î´[k-1]

+

1Î´[k-2]

22

 30/10/2019

Lineair en tijdsinvariant
u[k] =

2Î´[k]

+

3Î´[k-1]

+

1Î´[k-2]

y[k] =

2h[k]

+

3h[k-1]

+

1h[k-2]

Convolutie
â€¢ Formeel
   = `  []
  =`

d

a   b c[ âˆ’ b]

efd
d
âˆ‘efd  
âˆ‘d
efd  

b ` c[ âˆ’ b]
  =
  =
b â„[ âˆ’ b]
   =    âˆ— â„[]

Lineair
Tijdsinvariant

â€¢ Voor een systeem dat uit de nultoestand vertrekt !
â€¢ y[k] is de convolutie van u[k] en h[k]
â€¢ Uitvoer is convolutie van invoer en impulsresponsie

23

 30/10/2019

Convolutie
â€¢
â€¢
â€¢
â€¢

Commutatief: a[k] * b[k] = b[k] * a[k]
Associatief: (a[k] * b[k]) * c[k] = a[k] * (b[k] * c[k])
Neutraal element: a[k] * Î´[k] = a[k]
Lineair:
(r a[k] + s b[k]) * c[k] = r (a[k]*c[k]) + s (b[k]*c[k])

â€¢ Enkelzijdige signalen a[k] = b[k] = 0 voor k<0 :
d

E

efd

efR

0  = a P b /  âˆ’ b = aP b /  âˆ’ b
â€¢ Causaal systeem: h[k] = 0 voor k<0
 Geen respons vÃ³Ã³r de excitatie

Impulsresponsie
y[0] = C x[0] + D u[0]

k=0
k>0

Nulingangsresponsie

â€¢
â€¢
â€¢
â€¢

Nultoestandsresponsie

k= 0 : y[k] = d Î´[0] = d
u[k] = Î´[k] â‡’ in 2de term blijft enkel index j=0 staan
k > 0: enkel 2de term: y[k] = cAk-1b
k = 0:
y[k] = d

24

 30/10/2019

Voorbeeld
h[0] = d = 0
â„  = ' E & voor k>0
0
1 E 0
= 1 0
1/4 0
1



E &Ì…
â„  = 'Ì… 
  E
(= '
= 2
= 2



=



& = ' E &)
1n
1/2
0 E
2
âˆ’2
1n
0
âˆ’1/2
2
1n
()E
0
2
âˆ’2
0
( )E 1n
2

E

âˆ’ âˆ’





E

voor k>0 ; h[0]=0

-

Impulsresponsie van 1ste orde systeem
u[k]

x[k+1]

+

b

+

D

x[k]

c

y1[k]

Î»

x[k+1] = Î» x[k] + b u[k] ; y[k] = c x[k]
u[k] = Î´[k] ; nultoestand x[0]=0
k=0: u[0] = 1; x[1]=b ; y[k]=0
k=1: u[1] = 0 ; x[2] = Î» x[1] = b Î» ; y[1] = cb
k=2: u[2] = 0 ; x[3] = Î» x[2] = b Î»2 ; y[2] = cbÎ»
u[k] = 0 ; x[k+1] = bÎ»k ; y[k] = cbÎ»k-1 voor k>0 ; y[0]=0
y[k] = cbÎ»k-1 â„  = 2



E

âˆ’ 2 âˆ’

E

=

op
c
q
E


voor kâ‰¥0
âˆ’ âˆ’

E

k>0 ; h[0]=0

25

 30/10/2019

Vorm impulsresponsie
â€¢ h[0]=d ; h[k] = cAk-1b voor k > 0
â€¢ Zelfde bespreking als nulingangsresponsie
â€“ vb. 1ste orde systeem: cbÎ»k-1, zie boven

â€¢ Voor diagonaliseerbare A, som van:
o ExponentiÃ«el verloop (Î» reÃ«el)
o Schommelend exponentiÃ«el verloop (Î» complex)

26

 